rule Stuxnet_Under_the_Microscope
{
	strings:
		$Filename1 = "MRXCLS.sys"
		$Filename2 = "MRXNET.sys"
		$CVE1 = "CVE-2010-2772"
		$CVE2 = "CVE-2010-0249"
		$CVE3 = "CVE-2010-2568"
		$Filename3 = "jmidebs.sys"
		$URL1 = "http://www.h-online.com/security/news/item/Stuxnet-also-found-at-industrial-plants-in-Germany"
		$URL2 = "http://www.pbs.org/wgbh/pages/frontline/shows/cyberwar/interviews/weiss.html"
		$URL3 = "http://www.amazon.com/Protecting-Industrial"
		$Filename4 = "1081469.html"
		$Filename5 = "weiss.html"
		$Host1 = "www.h-online.com"
		$Host2 = "www.pbs.org"
		$URL4 = "http://support.automation.siemens.com/WW/view/en/43876783"
		$Filename6 = "Win32k.sys"
		$Host3 = "support.automation.siemens.com"
		$URL5 = "http://www.anti-virus.by/en/tempo.shtml"
		$URL6 = "http://www.sea.siemens.com/us/News/Industrial/Pages/WinCC_Update.aspx.sea.siemens.com/us/New"
		$URL7 = "http://www.kb.cert.org/vuls/id/940193"
		$URL8 = "http://www.us-cert.gov/control_systems/pdf/ICSA-10-201"
		$URL9 = "http://go.microsoft.com/?linkid=9738980"
		$URL10 = "http://go.microsoft.com/?linkid=9738981"
		$Filename7 = "new_rootkit_en.pdf"
		$Filename8 = "20Software.pdf"
		$Filename9 = "diary.html"
		$Host4 = "www.anti-virus.by"
		$Host5 = "www.sea.siemens.com"
		$Host6 = "aspx.sea.siemens.com"
		$Host7 = "www.kb.cert.org"
		$Host8 = "isc.sans.edu"
		$URL11 = "http://www.sea.siemens.com/us/News/Industrial/Pages/WinCC_Update.aspx"
		$URL12 = "http://www.wired.com/threatlevel/tag/siemens"
		$URL13 = "http://support.automation.siemens.com/WW/llisapi.dll?func=cslib.csinfo&lang=en&obji"
		$URL14 = "http://support.automation.siemens.com/WW/llisapi.dll?func=cslib.csinfo&objId=43876"
		$URL15 = "http://securityweek.com/shortcuts-insecurity-lnk-exploits"
		$Filename10 = "llisapi.dll"
		$Host9 = "securityweek.com"
		$URL16 = "http://www.scmagazineuk.com/microsoft-plugs-stuxnet-problems-as-nine-bulletins-are-released-on"
		$URL17 = "http://www.langner.com/en/index.htm"
		$URL18 = "http://realtimeacs.com/?page_id=65"
		$URL19 = "http://realtimeacs.com/?page_id=66"
		$URL20 = "http://www.virusbtn.com/conference/vb2010/programme/index"
		$Filename11 = "index.htm"
		$Filename12 = "w32_stuxnet_dossier.pdf"
		$Filename13 = "Raiu-VB2010.pdf"
		$Filename14 = "OMurchu-VB2010.pdf"
		$Host10 = "www.scmagazineuk.com"
		$Host11 = "www.langner.com"
		$Host12 = "realtimeacs.com"
		$URL21 = "http://www.infracritical.com/papers/stuxnet"
		$URL22 = "http://www.langner.com/en/2010/12/31/year-end-roundup"
		$URL23 = "http://www.langner.com/en/blog"
		$Host13 = "www.infracritical.com"
		$Filename15 = "win32k.sys"
		$URL24 = "http://www.stdlib.com/art6-Shortcut-File-Format-lnk.html"
		$Filename16 = "art6-Shortcut-File-Format-lnk.html"
		$Host14 = "www.stdlib.com"
		$URL25 = "http://www.metasploit.com/modules/exploit/windows/browser/ms10_046_shortcut_icon_dllloader"
		$Filename17 = "winsta.exe"
		$Filename18 = "spoolsv.exe"
		$Filepath1 = "C:\\addins\\DEFRAGdc2d0.TMP"
		$Filename19 = "rundll.exe"
		$Filename20 = "schedsvc.dll"
		$Filename21 = "Ntdll.dll"
		$Filename22 = "kerenl32.dll"
		$Filename23 = "ntdll.dll"
		$Filename24 = "lssas.exe"
		$Filename25 = "avp.exe"
		$Filename26 = "mcshield.exe"
		$Filename27 = "avguard.exe"
		$Filename28 = "bdagent.exe"
		$Filename29 = "UmxCfg.exe"
		$Filename30 = "fsdfwd.exe"
		$Filename31 = "rtvscan.exe"
		$Filename32 = "ccSvcHst.exe"
		$Filename33 = "ekrn.exe"
		$Filename34 = "tmproxy.exe"
		$Filename35 = "kernel32.dll"
		$Filename36 = "s7tgtopx.exe"
		$Filename37 = "CCProjectMgr.exe"
		$Filename38 = "s7apromx.dll"
		$Filename39 = "mfc42.dll"
		$Filename40 = "msvcrt.dll"
		$Filename41 = "ole32.dll"
		$Filename42 = "MrxCls.sys"
		$Filename43 = "MrxNet.sys"
		$Filename44 = "services.exe"
		$Filename45 = "s7otbxdx.dll"
		$Filename46 = "s7otbxdsx.dll"
		$Filename47 = "mrxcls.sys"
		$Filename48 = "mrxnet.sys"
		$Filename49 = "iexplore.exe"
		$Filename50 = "s7otbldx.dll"
		$IP1 = "4.2.1.1"
		$IP2 = "4.2.1.2"
		$IP3 = "4.2.1.3"
		$Filename51 = "S7tgtopx.exe"
		$Filename52 = "S7togtopx.exe"
		$Host15 = "www.mypremierfutbol.com"
		$Host16 = "www.todaysfutbol.com"
		$Registry1 = "HKLM\\SOFTWARE\\SIEMENS\\STEP7"
		$Registry2 = "HKLM\\SOFTWARE\\SIEMENS\\WinCC\\Setup"
		$URL26 = "http://www.h-online.com/security/news/item/Trojan-spreads-via-new-Windows-hole"
		$URL27 = "http://www.heise.de/newsticker/meldung/Trojaner-verbreitet-sich-ueber-neue-Windows"
		$URL28 = "http://www.reconstructer.org/main.html"
		$URL29 = "http://it.slashdot.org/submission/1283670/Malware-Targets-Shortcut-Flaw-in-Windows-SCADA"
		$URL30 = "http://it.slashdot.org/story/10/07/15/1955228/Malware-Targets-Shortcut-Flaw-In-Windows"
		$URL31 = "http://www.zdnet.co.uk/news/security/2010/07/16/spy-rootkit-goes-after-key-indian-iranian"
		$URL32 = "http://www.msnbc.msn.com/id/38315572"
		$URL33 = "http://www.reuters.com/article/idUSTRE66I5VX20100719"
		$URL34 = "http://forums.cnet.com/5208-6132_102-0.html?messageID=3341877"
		$URL35 = "http://news.softpedia.com/news/PoC-Exploit-Code-Available-for-Windows-LNK-Vulnerability"
		$URL36 = "http://www.computerworld.com/s/article/9179339/Windows_shortcut_attack_code_goes_pub"
		$URL37 = "http://www.google.com/hostednews/ap/article/ALeqM5h7lX0JoE1AGngQoEfWWmCM6THizQD"
		$URL38 = "http://www.dailytech.com/Hackers+Target+Power+Plants+and+Physical+Systems/article19257"
		$URL39 = "http://www.scmagazineus.com/keeping-hilfs-from-crashing-your-party/article/173975"
		$URL40 = "http://www.sans.org/newsletters/newsbites/newsbites.php?vol=12&issue=74"
		$URL41 = "http://www.computerworld.com/s/article/9185919/Is_Stuxnet_the_best_malware_ever_?taxo"
		$URL42 = "http://www.zdnet.co.uk/news/security-threats/2010/09/16/siemens-stuxnet-infected-14"
		$URL43 = "http://www.h-online.com/security/news/item/Stuxnet-worm-can-control-industrial-systems"
		$URL44 = "http://secunia.com/advisories/41525"
		$URL45 = "http://secunia.com/advisories/41471"
		$URL46 = "http://www.csoonline.com/article/614064/siemens-stuxnet-worm-hit-industrial-systemss"
		$Filename53 = "1038992.html"
		$Filename54 = "Luecke-1038281.html"
		$Filename55 = "main.html"
		$Filename56 = "5208-6132_102-0.html"
		$Filename57 = "00001993.html"
		$Filename58 = "1080751.html"
		$Filename59 = "32_stuxnet_dossier.pdf"
		$Host17 = "www.reconstructer.org"
		$Host18 = "it.slashdot.org"
		$Host19 = "www.zdnet.co.uk"
		$Host20 = "forums.cnet.com"
		$Host21 = "news.softpedia.com"
		$Host22 = "www.computerworld.com"
		$Host23 = "www.dailytech.com"
		$Host24 = "www.scmagazineus.com"
		$Host25 = "www.csoonline.com"
		$URL47 = "http://frank.geekheim.de/?p=1189"
		$URL48 = "http://www.faz.net/s/RubCEB3712D41B64C3094E31BDC1446D18E/Doc~E8A0D43832567452FB"
		$URL49 = "http://www.computerworld.com/s/article/9187300/Microsoft_confirms_it_missed_Stuxnet_pri"
		$URL50 = "http://news.sky.com/skynews/Home/World-News/Stuxnet-Worm-Virus-Targeted-At-Irans"
		$URL51 = "http://news.sky.com/skynews/Home/video/Stuxnet-Worm-Virus-Targeted-At-Irans-Nuclear"
		$URL52 = "http://www.bbc.co.uk/news/technology-11795076"
		$URL53 = "http://www.thinq.co.uk/2010/11/25/stuxnet-worm-hits-black-market"
		$URL54 = "http://thompson.blog.avg.com/2010/11/comment-on-stuxnet-and-more-windows-0-days.html"
		$URL55 = "http://www.msnbc.msn.com/id/3036697/#40280338"
		$URL56 = "http://www.itproportal.com/2010/11/25/microsoft-reveals-code-vulnerable-stuxnet"
		$URL57 = "http://www.eweek.com/c/a/Security/Exploit-Code-for-Windows-Zeroday-Targeted-by-Stuxnet"
		$URL58 = "http://blogs.protegerse.com/laboratorio/2010/11/24/publicado-el-codigo-de-otra-de-las"
		$URL59 = "http://www.v3.co.uk/v3/news/2273495/stuxnet-black-market-sky-news"
		$URL60 = "http://www.facebook.com/notes/eset-ireland/cyberthreats-daily-facebook-infested-with-new"
		$URL61 = "http://af.reuters.com/article/energyOilNews/idAFLDE6AS1L120101129"
		$URL62 = "http://go.theregister.com/i/cfh/http://www.theregister.co.uk/2010/11/29/stuxnet_stuxnet"
		$URL63 = "http://www.h-online.com/security/news/item/Report-Stuxnet-code-being-sold-on"
		$URL64 = "http://blogs.forbes.com/firewall/2010/12/14/stuxnets-finnish-chinese-connection/#more-2513"
		$URL65 = "http://taiaglobal.com/?attachment_id=81"
		$URL66 = "http://www.darkreading.com/vulnerability-management/167901026/security/attacks"
		$URL67 = "http://www.infracritical.com/papers/stuxnet-timeline.txt"
		$URL68 = "http://www.vimeo.com/18225315"
		$Filename60 = "Scontent.html"
		$Filename61 = "comment-on-stuxnet-and-more-windows-0-days.html"
		$Filename62 = "00002040.html"
		$Filename63 = "black-market-1142866.html"
		$Filename64 = "china-likely-behind-stuxnet-attack-cyberwar-expert-says.html"
		$Host26 = "frank.geekheim.de"
		$Host27 = "www.faz.net"
		$Host28 = "news.sky.com"
		$Host29 = "www.thinq.co.uk"
		$Host30 = "www.itproportal.com"
		$Host31 = "www.eweek.com"
		$Host32 = "blogs.protegerse.com"
		$Host33 = "www.v3.co.uk"
		$Host34 = "go.theregister.com"
		$Host35 = "taiaglobal.com"
		$Host36 = "www.vimeo.com"
	condition:
		$Filename1 or $Filename2 or $CVE1 or $CVE2 or $CVE3 or $Filename3 or $URL1 or $URL2 or $URL3 or $Filename4 or $Filename5 or $Host1 or $Host2 or $URL4 or $Filename6 or $Host3 or $URL5 or $URL6 or $URL7 or $URL8 or $URL9 or $URL10 or $Filename7 or $Filename8 or $Filename9 or $Host4 or $Host5 or $Host6 or $Host7 or $Host8 or $URL11 or $URL12 or $URL13 or $URL14 or $URL15 or $Filename10 or $Host9 or $URL16 or $URL17 or $URL18 or $URL19 or $URL20 or $Filename11 or $Filename12 or $Filename13 or $Filename14 or $Host10 or $Host11 or $Host12 or $URL21 or $URL22 or $URL23 or $Host13 or $Filename15 or $URL24 or $Filename16 or $Host14 or $URL25 or $Filename17 or $Filename18 or $Filepath1 or $Filename19 or $Filename20 or $Filename21 or $Filename22 or $Filename23 or $Filename24 or $Filename25 or $Filename26 or $Filename27 or $Filename28 or $Filename29 or $Filename30 or $Filename31 or $Filename32 or $Filename33 or $Filename34 or $Filename35 or $Filename36 or $Filename37 or $Filename38 or $Filename39 or $Filename40 or $Filename41 or $Filename42 or $Filename43 or $Filename44 or $Filename45 or $Filename46 or $Filename47 or $Filename48 or $Filename49 or $Filename50 or $IP1 or $IP2 or $IP3 or $Filename51 or $Filename52 or $Host15 or $Host16 or $Registry1 or $Registry2 or $URL26 or $URL27 or $URL28 or $URL29 or $URL30 or $URL31 or $URL32 or $URL33 or $URL34 or $URL35 or $URL36 or $URL37 or $URL38 or $URL39 or $URL40 or $URL41 or $URL42 or $URL43 or $URL44 or $URL45 or $URL46 or $Filename53 or $Filename54 or $Filename55 or $Filename56 or $Filename57 or $Filename58 or $Filename59 or $Host17 or $Host18 or $Host19 or $Host20 or $Host21 or $Host22 or $Host23 or $Host24 or $Host25 or $URL47 or $URL48 or $URL49 or $URL50 or $URL51 or $URL52 or $URL53 or $URL54 or $URL55 or $URL56 or $URL57 or $URL58 or $URL59 or $URL60 or $URL61 or $URL62 or $URL63 or $URL64 or $URL65 or $URL66 or $URL67 or $URL68 or $Filename60 or $Filename61 or $Filename62 or $Filename63 or $Filename64 or $Host26 or $Host27 or $Host28 or $Host29 or $Host30 or $Host31 or $Host32 or $Host33 or $Host34 or $Host35 or $Host36
}